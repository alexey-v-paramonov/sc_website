{{ define "main" }}
<main class="view pb posr bg-light">
  <img class="bg-light__img posa pointer db" src="/img/view-bg.svg" alt="" />
  <div class="container index">
    {{ partial "breadcrumbs.html" . }}

    <div class="card-list df jcsb">
      <div class="card-left">
        <div class="card-top df aic">
          <div class="card-star dif aic">
            <img src="/img/star.svg" alt="" class="img">
            <span>{{ .Params.rating }}</span>
          </div>
          <div class="card-top__item card-top__item-votes df aic">{{ T "total_votes" }} <span>{{ .Params.total_votes }}</span>
          </div>
          <div class="card-top__item df aic"><img src="/img/radio.svg" alt="">{{ T "catalog_created" }}: <span>{{ .Params.created
              }}</span></div>
        </div>
        <h1 class="card-title">{{ .Title }}</h1>
        <a href="{{ .Params.website_url }}" target="_blank"
          class="card-link hide link link-only-mob">{{ .Params.website_url }}</a>
        <img src="{{ .Params.logo }}" alt="{{ .Title }}" title="{{ .Title }}"
          class="img card-right__img card-right__img-mobile">

        <div class="card-mobile hide">
          <div class="card-right__item">
            <div class="card-right__item-title">{{ T "location" }}</div>
            <div class="card-right__item-flex df aic">
                <img src="/catalog/flags/{{ .Params.country_code }}.png" alt="{{ .Params.country_name }}"
                  title="{{ .Params.country_name }}" class="img"/> &nbsp;

                <span class="db"> {{ .Params.country_name }} {{ if .Params.region_name }}> {{ .Params.region_name }}{{
                  end }} {{ if .Params.city_name }}> {{ .Params.city_name }}{{ end }}
                </span>
            </div>
          </div>
          <div class="card-right__item">
            <div class="card-right__item-title">{{ T "language" }}</div>
            <div class="card-right__item-flex df aic">
              <!-- <img src="img/lang-2.svg" alt="" class="img"> -->
              <span class="db"> {{ range .Params.languages }}
                  <span>{{ . }}</span>
                  {{ end }}
              </span>

            </div>
          </div>
          <div class="card-right__item">
            <div class="card-right__item-title">{{ T "genres" }}</div>
            <div class="card-right__item-list df aic fxw">
              {{ range .Params.genres }}
                <div class="card-right__item-hash dif aic">#{{ . }}</div>
              {{ end }}
            </div>
          </div>
        </div>

        <div class="card-mob-list hide">
          <div class="card-top__item df aic"><img src="/img/radio.svg" alt="">{{ T "catalog_created" }}: <span>{{ .Params.created }}</span></div>
        </div>
        
        <a href="{{ .Params.website_url }}" target="_blank"
          class="card-link db link">{{ .Params.website_url }}</a>
        <div class="card-text">{{ .Params.description }}</div>

        <div class="card-flex">
          {{ if .Params.default_stream }}
          <audio id="stream-audio" class="stream-audio" preload="none">
            <source src="{{ .Params.default_stream }}" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>

          <div class="card-player">
            <div class="player">
              <div class="player-btn"></div>
              <div class="player-select">
                <div class="select">
                  <select id="stream-select">
                    {{ range $i, $stream := .Params.streams }}
                    <option value="{{ $stream.stream_url }}" data-id="{{ $stream.id }}" {{ if eq $i 0 }}selected{{ end }}>{{ $stream.bitrate }}kbps {{ $stream.audio_format }}</option>
                    {{ end }}
                  </select>
                </div>
              </div>
              <div class="volume-wrapper">
                <div class="volume-icon"></div>
                <div class="volume-slider">
                  <div class="volume-fill" style="width: 70%;"><span></span></div>
                </div>
              </div>
              <div class="player-time">00:00</div>
            </div>
          </div>
          {{ end }}

          <div class="card-flex__right">
            <div class="card-flex__right-title">{{ T "links" }}</div>
            <div class="card-flex__right-list">
              <a id="link-m3u" href="/listen/stream_{{ (index .Params.streams 0).id }}.m3u" download class="card-flex__right-link">
                <img src="/img/link-1.svg" alt="" class="img">
                <span>m3u</span>
              </a>
              <a id="link-pls" href="/listen/stream_{{ (index .Params.streams 0).id }}.pls" download class="card-flex__right-link">
                <img src="/img/link-1.svg" alt="" class="img">
                <span>PLS</span>
              </a>
              <a id="link-web" href="{{ (index .Params.streams 0).stream_url }}" class="card-flex__right-link">
                <img src="/img/link-1.svg" alt="" class="img">
                <span>Web</span>
              </a>
            </div>
          </div>
        </div>

        <div class="card-save">
          <div class="card-soc__title"><img src="/img/radio.svg" alt=""><strong>{{ T "share_save_radio" }}</strong></div>
          <div class="card-save__list">
            {{ if eq .Lang "en" }}
            <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
                <a class="a2a_button_email"></a>
                <a class="a2a_button_copy_link"></a>
                <a class="a2a_button_facebook"></a>
                <a class="a2a_button_telegram"></a>
                <a class="a2a_button_mastodon"></a>
                <a class="a2a_button_google_gmail"></a>
                <a class="a2a_button_snapchat"></a>
                <a class="a2a_button_twitter"></a>
                <a class="a2a_button_wechat"></a>
                <a class="a2a_button_whatsapp"></a>
                <a class="a2a_button_reddit"></a>
                <a class="a2a_button_linkedin"></a>
                <a class="a2a_button_x"></a>
                <a class="a2a_button_vk"></a>
                <a class="a2a_button_odnoklassniki"></a>
                <a class="a2a_button_viber"></a>
              </div>
            {{ end }}
            {{ if eq .Lang "ru" }}
            <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
              <a class="a2a_button_email"></a>
              <a class="a2a_button_copy_link"></a>
              <a class="a2a_button_telegram"></a>
              <a class="a2a_button_snapchat"></a>
              <a class="a2a_button_twitter"></a>
              <a class="a2a_button_wechat"></a>
              <a class="a2a_button_whatsapp"></a>
              <a class="a2a_button_reddit"></a>
              <a class="a2a_button_linkedin"></a>
              <a class="a2a_button_x"></a>
              <a class="a2a_button_vk"></a>
              <a class="a2a_button_odnoklassniki"></a>
            </div>
            {{ end }}
          </div>
        </div>

        <div class="card-soc" id="radio-voting-bar" 
             data-server-url="{{ $.Site.BaseURL }}" 
             data-radio-id="{{ $.Params.id }}"
             data-msg-success="{{ T "vote_success" }}"
             data-msg-already-voted="{{ T "vote_already_voted" }}"
             data-msg-forbidden="{{ T "vote_forbidden" }}"
             data-msg-error="{{ T "vote_error" }}"
             data-msg-network-error="{{ T "vote_network_error" }}">
          <div class="card-soc__wrapper">
            <div class="card-soc__title"><img src="/img/radio.svg" alt="">{{ T "rating_title" }} <span>{{ T "rate_radio" }}</span>
            </div>
            <div class="card-soc__scroll">
              <div class="card-soc__list">

                {{ range $i := seq 1 10 }}
                  <div class="card-soc__block voting-item" data-score="{{ $i }}">
                    <label class="card-soc__radio">
                      <input type="radio" name="rating">
                      <img src="/img/smile_{{ $i }}.svg" alt="" class="img">
                      <span>{{ $i }}</span>
                      <small></small>
                    </label>
                  </div>
                {{ end }}
              </div>
            </div>
          </div>
          <div id="vote-alert" class="index vote-alert" style="display: none;"></div>
          <div class="card-soc__bottom">
            <span>{{ T "final_rating" }} <strong>{{ .Params.rating }}</strong> {{ T "out_of" }}</span>
            <small>({{ .Params.total_votes }} {{ T "votes" }})</small>
          </div>
        </div>

        <div class="card-left__mobile">
          <a class="card-right__btn btn" href="{{ T "signup_url" }}"><img class="db" src="/img/marker.svg" alt=""><span
              class="db">{{ T "add_your_radio" }}</span></a>
        </div>


        <div class="card-box card-reviews">
          <div class="card-box__wrapper">
            
            {{ if eq .Lang "en" }}
            <!-- Facebook Comments Plugin -->
            <div class="index fb-comments" data-href="{{ .Permalink }}" data-width="100%" data-numposts="7"></div>
            {{ end }}

            {{ if eq .Lang "ru" }}
            <!-- VK comments container -->
            <div class="index comments-wrap"><div id="vk_comments"></div></div>
            {{ end }}
          </div>
        </div>
      </div>

      <div class="card-right">
        <div class="card-sticky">
          <div class="card-right__box">
            <img src="{{ .Params.logo }}" alt="{{ .Title }}" title="{{ .Title }}" class="img card-right__img">

            <div class="card-right__item">
              <div class="card-right__item-title">{{ T "location" }}</div>
              <div class="card-right__item-flex df aic">
                <img src="/catalog/flags/{{ .Params.country_code }}.png" alt="{{ .Params.country_name }}"
                  title="{{ .Params.country_name }}" class="img"/> &nbsp;

                <span class="db"> {{ .Params.country_name }} {{ if .Params.region_name }}> {{ .Params.region_name }}{{
                  end }} {{ if .Params.city_name }}> {{ .Params.city_name }}{{ end }}
                </span>
              </div>
            </div>
            <div class="card-right__item">
              <div class="card-right__item-title">{{ T "language" }}</div>
              <div class="card-right__item-flex df aic">
                <!--<img src="img/lang-2.svg" alt="" class="img">-->
                <span class="db"> {{ range .Params.languages }}
                  <span>{{ . }}</span>
                  {{ end }}
                </span>
              </div>
            </div>
            <div class="card-right__item">
              <div class="card-right__item-title">{{ T "genres" }}</div>
              <div class="card-right__item-list df aic fxw">
                {{ range .Params.genres }}
                <div class="card-right__item-hash dif aic">#{{ . }}</div>
                {{ end }}

              </div>
            </div>

          </div>
          <a class="card-right__btn btn" href="{{ T "signup_url" }}"><img class="db" src="/img/marker.svg" alt=""><span
              class="db">{{ T "add_your_radio" }}</span></a>
        </div>
      </div>
    </div>
  </div>

</main>

{{ if eq .Lang "ru" }}
<script>
  // Initialize VK comments when on detail page
  window.addEventListener('load', function () {
    if (typeof VK !== 'undefined' && document.getElementById('vk_comments')) {
      VK.init({ apiId: 54450993, onlyWidgets: true });
      VK.Widgets.Comments("vk_comments", {
        limit: 10,
        attach: "*",
        pageUrl: "{{ .Permalink }}",
        width: "100%"
      });
    }
  });
</script>
{{ end }}

{{ end }}